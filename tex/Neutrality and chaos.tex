\documentclass[a4paper, onecolumn, 10pt]{article}

\usepackage[english]{babel}
\usepackage[latin1]{inputenc}
\usepackage[T1]{fontenc}

\usepackage{float} % For controlling figure positions
\usepackage{etoolbox} % For using conditionals
\usepackage{amsthm} % For using \begin{proof}...
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{fancybox}
\usepackage{color}
\usepackage{cite}
\usepackage{url}

%\usepackage{algorithm}
%\usepackage[noend]{algpseudocode}
%\usepackage{program}

\usepackage{authblk}

%% Control draft / final version
\newtoggle{personalDraft}
\toggletrue{personalDraft}

\newtoggle{journalDraft}
\togglefalse{journalDraft}

\title{Neutral competition among prey promotes chaos in two-level food webs \iftoggle{personalDraft}{\\ {\color{red} }}}
\author[1]{Pablo Rodríguez-Sánchez \thanks{pablo.rodriguezsanchez@wur.nl}}
\author[1]{Egbert van Nes \thanks{egbert.vannes@wur.nl}}
\author[1]{Marten Scheffer \thanks{marten.scheffer@wur.nl}}

\affil[1]{Department of Aquatic Ecology, Wageningen University, The Netherlands}

%% Control graphics
\usepackage{graphicx}
\graphicspath{ {../img/} }

\usepackage[switch]{lineno}

\iftoggle{journalDraft}
{
	\linenumbers
}

\begin{document}

\maketitle

\begin{abstract}
\label{sec:Abstract}
Neutral competition can be interpreted as a limit case between dominant intraspecific competition and dominant interspecific competition. Using a numerical model of an ecosystem with two trophic levels, we explore the surroundings of this limit case, that is, weak non-neutral competition interactions. It is shown that, the closer the competition is to neutrality, the higher are the chances of the system to develop chaotic behaviour.

\paragraph{}
\textit{Keywords}: population dynamics, competition models, neutral competition, biodiversity paradox, chaos.
\end{abstract}

\iftoggle{personalDraft}
{
	\clearpage
	\tableofcontents
	\clearpage
}

\section{Background}
\label{sec:Background} % Introductory paragraph
The fascination by biodiversity is one of the main motivations for studying ecology. Even very young children feel the joy of learning about different species, so no prior knowledge of biology seems to be a requirement for being sensitive to the amazing variety of life. Scientific knowledge increases this sense of wonder even more. Like in a good mystery book, there is a big unknown behind biodiversity: we don't know how it is possible.

\paragraph{} % Introduction of the biodiversity paradox TODO: citations
The mystery comes into scene together with the competitive exclusion principle\cite{Hardin1960}, sometimes referred to as Gause's law. This principle, which some authors trace back to Charles Darwin's \textit{On the origin of the species}\cite{Darwin1859}, is one of the classical touchstones of ecology. The principle states that \textit{"for each niche only one species will dominate in the long run, out-competing the rest"}. Most competition models satisfy this principle, and it has been observed experimentally under laboratory conditions. On the other hand, most of the field observations seem to contradict the competitive exclusion principle, being the huge biodiversity in Earth its most noticeable counterexample. This contradiction is known as the biodiversity paradox. The paradox can be carelessly (but poetically) rephrased as \textit{Why are there so many species?}

%% Brief discussion about the alternative hypotheses
\paragraph{} % Introduction and hypotheses based in non-autonomous systems
There are several alternative hypotheses for escaping the paradox. For instance, Hutchinson\cite{Hutchinson} reports his observations on two sympatric species of beetles competing for the same resource, but not simultaneously because of having different breeding seasons. This means that time, and not only space, needs to be taken into account in the definition of ecological niche. In a later, influential paper\cite{Hutchinson1961}, Hutchinson proposes the possibility of ecosystems to be driven by external, time-dependent environmental changes. If the characteristic times of this environmental changes are fast enough, the ecosystem is prevented to reach an equilibrium. 

\paragraph{} % Introduction of chaotic dynamics
After the discovery of chaos\cite{Lorenz1963}, it has been shown that non-equilibrium ecosystems can arise as well under constant environmental conditions\cite{Huisman1999}. More specifically, those ecosystems develop cyclic or chaotic dynamics instead of equilibrium. Of course, chaotic dynamics can arise as well in non-constant environments \cite{Dakos2009b}.

\paragraph{} % Hypotheses based in spatial heterogeneity TODO: enlarge or remove?
All the previous hypotheses refer to the time domain. Regarding the spatial dimension, the inhomogeneity of ecosystems, and the possibility of migration between them has been pointed out as another possible explanation of the paradox \cite{Tilman1994}.

\paragraph{} % Introduction of the neutral theory TODO: citations
Another hypotheses deserving attention are that of neutral competition, whose better known exponent is \textit{Hubbell's neutral competition theory} \cite{Hubbell2001}. In neutral models, similar species inside an ecological community are assumed to have identical \textit{per capita} rates of birth, death, reproduction, etc. In those models, the long term differences between species are a result of random events. Despite its counter-intuitive and controversial foundations, neutral models have been successfully applied to populations of rainforest trees.
%% -----

\paragraph{} % Introduction to our contribution
In the present paper we explore the links between neutral competition and the type of long term dynamics exhibited. Using weakly non-neutral models, our simulations show that the likelihood of ending up inside a chaotic attractor increases with neutrality at the competitors' trophic level. That is, that neutrality promotes chaos.

\section{Methods}
\label{sec:Methods}

\subsection{Model description}
\label{subsec:Model}
We focused our attention in food webs with two trophic levels, one of consumers and another of prey (see figure \ref{fig:Network}). The consumers predate on the prey, and the prey populations compete among each other for a common source of resources. 

\paragraph{}
This choice was made because two-level webs are the simplest realization of a system where neutrality doesn't lead to mathematical degeneration. The need of a second trophic level (that of predators) may seem in contradiction with this pursue of simplicity, but actually this is a requirement for the effect to take place. In the absence of non-uniform predation, chaos will never develop\footnote{If all interactions become equally strong, the differences among species at the same trophic level fade out. This makes labeling each species meaningless, and thus the system can be reduced just to two differential equations, the one for the total population of prey and the one for the total population of consumers. It can be proven that chaos cannot be developed in autonomous two-dimensional systems. For details, see Poincaré-Bendixson theorem.}. Degeneration is prevented by the non-neutral predation rates breaking the excess of symmetry provided by neutrality at the prey's level. % TODO: maybe not needed in an ecology journal

\begin{figure}[h]
	\begin{center}
		\includegraphics[width=0.7\columnwidth]{net.png}
	\end{center}
	\caption{Example with $2$ consumers and $3$ prey. Each one of the red links represents a predation interaction (coded in the matrix of palatability coefficients, $ S $). Each green link represents a competition interaction (coded in the matrix of competition coefficients, $ A $). The closed green loops are related with carrying capacity (diagonal elements of $ A $) interpreted here as intra-species competition.}
	\label{fig:Network}
\end{figure}

\paragraph{} % Description of the dynamics
The dynamics were modelled as a system of ordinary differential equations. We used the Rosenzweig-MacArthur predator-prey model \cite{Rosenzweig1963} generalized to a higher number of species \cite{Scheffer2004}. Our model is composed of $ n_P $ prey species and $ n_C $ consumer species. $ P_i(t) $ was used for accounting the size of the population of prey $ i $ at time $ t $, and $ C_j(t) $ for the population of consumer $ j $. When it is not explicitly stated, $ i $  runs from $ 1 $ to $ n_P $, and $ j $ from $ 1 $ to $ n_C $. The prey compete directly among themselves, while the consumers don't interact directly. The prey competition is not necessarily symmetrical. The consumers eat all kind of prey (see figure \ref{fig:Network}), but find some of them more preferable than others. All these interactions are summarized in \ref{fig:Network}. The overall structure looks like:

\begin{displaymath}
\label{eq:EquationInPseudocode}
	\begin{cases}
	\frac{d}{dt} \left( Prey \right) = Growth  - Predation + Immigration \\
	\frac{d}{dt} \left( Cons \right) = Feeding - Death \\
	\end{cases}
\end{displaymath}

%% Step-by-step description of each term
The growth term is modelled as a multispecies logistic growth. The strength of the competition between species $ i $ and $ k $ is given by $ A_{ik} $. Those coefficients can be arranged as an $ n_P \times n_P $ matrix. So, for prey $ i $, we have:

\begin{equation}
\label{eq:Growth-Competition}
%\resizebox{.8 \columnwidth}{!}
%{
Growth_i  = r P_i \left( 1 - \frac{1}{K} \sum_{k=1}^{n_P} A_{ik} \cdot P_k \right)
%}
\end{equation}

The palatability of each prey species is given by $ S_{ij} $. That is, $ S_{ij} $ represents the weight that consumer $ j $ gives to prey $ i $ in his \textit{menu}. Those coefficients can be arranged as an $ n_C \times n_P $ matrix. Being a multispecies model, we can define the auxiliary variable $ V_j $ as a sum of the prey's populations weighted by the palatability coefficients. Biologically, this represents the composition of the \textit{menu} of consumer $ j $:

\begin{eqnarray}
\label{eq:MenuFunction}
	V_j(P) \equiv \sum_{k=1}^{n_P} S_{jk} \cdot P_k
\end{eqnarray}

We hypothesized that the feeding term will be linear in $ C_j $, and have a Holling type II functional response on $ V_j $ in order to account for consumer satiation: % TODO cite Edelstein Keshet

\begin{equation}
\label{eq:Feeding}
	Feeding_j =  e g C_j F_{2}(V_j; H)
\end{equation}

$ e $ represents the assimilation efficiency of the predation, that is, it regulates the biomass exchange between consumer and prey. Thus, the effect of consumer $ j $ on all prey's populations is given by $ Feeding_j/e $. Knowing this, we can sum the effect of all consumers in the prey species $ i $ as follows:

\begin{equation}
\label{eq:Predation}
Predation_i = g \sum_{k=1}^{n_C} \left(\frac{S_{ki}P_i}{V_k}\right) C_k F_{2}(V_j; H)
\end{equation}

Where the term inside the parentheses represents the relative weight of prey species $ i $ inside "the menu" of predator $ k $. It is interesting to note that the way the predation and feeding terms are defined satisfies the following property:

\begin{equation}
\label{eq:Balance}
\sum_{j=1}^{n_C} Feeding_j = e \sum_{i=1}^{n_P} Predation_i
\end{equation}

that is, all the deaths at the prey level are invested in the growth of consumers. For future clarity, it is a good idea to define the auxiliary function $ R_i $ as a summary of the effect of all consumers on prey $ i $:

\begin{equation}
\label{eq:PredationAux}
R_i(P,C) \equiv \sum_{k=1}^{n_C} \left(\frac{S_{ki}P_i}{V_k(P)}\right) C_k F_{2}(V_k(P); H) 
\end{equation}

Putting all together, the dynamical system reads:

\begin{eqnarray}
\label{eq:SystemUnderStudy}
	\begin{cases}
	\dot{P_i} = r P_i \left( 1 - \frac{1}{K} \sum_{k=1}^{n_P} A_{ik} \cdot P_k \right) - g R_i(P,C) + f
	\\ 
	\dot{C_j} = e g C_j F_{2}(V_j(P); H) - l C_j
	\end{cases}
\end{eqnarray}
%% ------

Depending on the parameters and the initial conditions, this system can give rise to three types of asymptotic behaviour, each of them corresponding with a different type of attractor. The easier one, corresponding to a stable point attractor, gives rise to a constant species composition. Cyclic attractors give rise to periodic behaviour in the species composition. Finally, chaotic attractors, make the species composition keep changing without stabilising nor giving rise to periodicity (see figure \ref{fig:TimeSeries}).

\begin{figure}
	\begin{center}
		\includegraphics[width=1\columnwidth]{ts.png}
	\end{center}
	\caption{Our model generates time series of the population of each species. The time series can be classified in $3$ types depending on their asymptotic behavior: \textit{stable}, \textit{periodic} and \textit{chaotic}. In \textbf{figure A}, the system reaches a stable attractor after a transient time. In \textbf{figure B}, a periodic attractor, with an approximate period of 1000 days, is reached after the transient time. The system in \textbf{figure C} never reaches a stable nor a cyclic attractor, but a chaotic one.}
	\label{fig:TimeSeries}
\end{figure}

\subsection{Parameterization}
\label{subsec:Parameterization}
For the parameterization of our model we used \cite{Dakos2009b} as a reference. Dakos' model, focusing on plankton communities, uses as well a Rosenzweig-McArthur dynamic with two trophic levels (that of zooplankton and phytoplankton). Unlike Dakos, who uses periodic, time-dependent parameters, our parameters will be constant.

\begin{figure}[H]
	\begin{center}
		\resizebox{\columnwidth}{!}{%
		\begin{tabular}{|c|c|c|c|}
			\hline
			\textbf{Symbol} & \textbf{Interpretation} & \textbf{Value} & \textbf{Units} \\
			\hline
			$r$ & Growth rate & $0.50$ & $d^{-1}$ \\
		    \hline
			$K$ & Carrying capacity & $1.00$ & $ mg \ l^{-1} $ \\
			\hline
			$g$ & Predation rate & $0.40$ & $d^{-1}$\\
			\hline
			$f$ & Immigration rate & $10^{-5}$ & $mg \ l^{-1} \ d^{-1}$\\
			\hline
			$e$ & Assimilation efficiency & $0.60$ & $1$\\
			\hline
			$H$ & Half-saturation constant & $2.00$ & $ mg \ l^{-1} $\\
		    \hline
			$l$ & Loss rate & $0.15$ & $d^{-1}$\\
			\hline
		    $S$ & $ n_C \times n_P $ palatability matrix & $S_{ij} \sim (0,1)$ & $1$\\
		    \hline
   		    $A$ & $ n_P \times n_P $ competition matrix & See section \ref{subsubsec:CompetitionParameter} & $1$\\
		    \hline
		\end{tabular}}
	\end{center}
	\caption{Values and meanings of the parameters used in our numerical experiment}
	\label{tab:Parameters}
\end{figure}

\subsubsection{Competition parameter}
\label{subsubsec:CompetitionParameter}

Our aim is to analyze the behavior of the system described in equation \ref{eq:SystemUnderStudy} for competition interactions differing in neutrality. In order to quantify neutrality and controlling how neutral the competition is, we introduce the competition parameter $ \epsilon $. This dimensionless parameter allows us to vary continuously from interactions where intraspecific competition is stronger than interspecific (for $ \epsilon < 0 $) to the opposite case (for $ \epsilon > 0$). The border between both cases (i.e. $ \epsilon = 0 $), where neither the intra nor the interspecific competition is dominant, represents neutral competition (see figure \ref{fig:CompetitionParameter}).

\paragraph{}
The numerical implementation of these ideas can be easily achieved by building a competition matrix whose non diagonal terms are perturbed by an additive random number $W$, whose size is controlled by $\epsilon$ (see figure \ref{fig:CompetitionParameter} and equation \ref{eq:NeutralityParameter}).

\begin{eqnarray}
\label{eq:NeutralityParameter}
	A_{ij}(\epsilon) = 	\begin{cases}
		1 & \text{ : } i=j \\ 
		1 + W(\epsilon) & \text{ : } i \neq j
	\end{cases}
\end{eqnarray}

The random numbers $W$ have been drawn from a uniform distribution\footnote{Other distributions have been tried, leading to the same qualitative results.} of width $0.2$ centered in $\epsilon$, and forced to never be lower than $0$ nor higher than $2$. This parameterization allows us to travel continuously from strong dominant intraspecific to strong interspecific competition, meeting neutral competition at the border in between.

\begin{figure}[H]
	\begin{center}
		\includegraphics[width=1\columnwidth]{epsilon_all.png}
	\end{center}
	\caption{The competition matrix on the left is a clear case of dominant intraspecific competition. The central one represents a case of neutral competition. The matrix in the right panel shows a case of dominant interspecific competition. The difference between them is the relative size of the non-diagonal elements respective of the diagonal ones. This qualitative properties of the competition matrices is controlled by the parameter $\epsilon$.}	
	\label{fig:CompetitionParameter}
\end{figure}

\subsection{Numerical experiment}
\label{subsec:NumericalExperiment}
Our main target is to estimate the probability of reaching a chaotic attractor under different intensities of neutrality. In order to achieve this, we'll simulate several ecosystems with different initial conditions and relative predation intensities, but sharing the same competition parameter. We consider thus that those ecosystems share a qualitative property: neutrality. 

We use numerical methods to integrate the equation \ref{eq:SystemUnderStudy}. As a result, we obtain time series as the ones in figure \ref{fig:TimeSeries}. Using the Gottwald-Melbourne [CITE] test\footnote{We also applied the maximum Lyapunov exponent test, finding the same qualitative results.}, we classify each individual simulation as \textit{chaotic} or \textit{non-chaotic}. The ratio of attractors found to be chaotic can be used to estimate the probability of ecosystems in the given parameter range developing chaotic asymptotic behavior.

For the sake of reproducibility, we provide a \textit{GitHub} link to the analysis scripts used.

%\paragraph{}
%Sweeping for different values of $ \epsilon $, we use the following procedure to estimate the probability of a chaotic attractor:
%
%\begin{enumerate}
%	\item Use the competition parameter $ \epsilon $ to draw a competition matrix $ A $ (as described in section \ref{subsubsec:CompetitionParameter}). Notice that this matrix is being drawn from a probability distribution function (PDF), so it will change in every run.
%	\item \label{StartOfAnExperiment} Draw the rest of parameters and initial conditions from the values described in \cite{Dakos2009b}. Those which are defined as ranges will be taken as uniform PDFs. Notice that those parameters taken from a PDF will change in every run.
%	\item Simulate the dynamics numerically.
%	\item Perform two different tests of chaoticity on the simulation (see section \ref{subsec:DetectionOfChaos}).
%	\item Go back to step (\ref{StartOfAnExperiment}) $ R $ times.
%\end{enumerate}

For those more familiar with flow charts, figure \ref{fig:FlowChart} can be illuminating.

\begin{figure}[H]
	\begin{center}
		\includegraphics[width=0.9\columnwidth]{flow_chart.png}
	\end{center}
	\caption{Flow chart describing the numerical experiment}
	\label{fig:FlowChart}
\end{figure}

\paragraph{}
This numerical experiment can be repeated for food webs of different sizes. In our simulations, we kept a ratio of 2:3 for the number of species at the consumer and the prey level.

\section{Results}
\label{sec:Results}
Plotting the probability of chaos against the competition parameter (see figures \ref{fig:Results} and \ref{fig:Contour}), we observe a clear maximum around $ \epsilon = 0 $. That is, for neutral competition at the prey's trophic level, the likelihood of chaotic behaviour is higher than for dominant inter or intraspecific competition. From the biological point of view, we show that neutrality and non-equilibrium asymptotic dynamics are not completely independent.

\paragraph{} % Weak and strong interspecific competition
There's another local maximum for $ \epsilon = -1 $. This means that strong intraspecific interactions also promote chaos [CITATION?].

\paragraph{} % Valley
The probability of chaos has a local minimum between $ \epsilon = -1 $ and $ \epsilon = 0 $, whose exact position differs between experiments. We interpret this result as a consequence of the two previous effects: assuming continuity, there should be necessarily at least one minimum between two maxima\footnote{This is a direct consequence of applying Bolzano's theorem to the first derivative. Intuitively: there should be at least one valley between two mountains}.

\paragraph{} % Chaos and dimensionality
The overall likelihood of chaos, which can be interpreted as the area under the curve, increases with the size of the food web (see figure \ref{fig:Results}). This effect should not be surprising: the more dimensions the phase space has, the easier is to fulfill the requirements of the complex geometry of a chaotic attractor\footnote{We can understand this intuitively as increasing the available room for the trajectories to pack closer and closer without ever crossing each other nor collapsing to a point}. Even in those higher dimensional cases, a maximum is still happening at the neutral competition case.

\begin{figure}
	\begin{center}
		\includegraphics[width=0.65\columnwidth]{results.png}
	\end{center}
	\caption{Results for a low, medium and high dimensional system. The upper row represents the measured Lyapunov exponents, coloured in red if larger than zero, and in blue if lower. The lower row represents the estimated probability of chaotic behaviour}
	\label{fig:Results}
\end{figure}

\begin{figure}
	\begin{center}
		\includegraphics[width=1\columnwidth]{contour.png}
	\end{center}
	\caption{Contour map showing the probability of chaos for various competition parameters (horizontal axis) and prey populations (vertical axis). The consumers' population is fixed as $ 2/3 $ of the prey's population, in order to control the overall size of the system with a single parameter. Notice that chaotic attractors appear more easily (i.e., for smaller systems) if the competition is neutral (i.e., $ \epsilon = 0 $)}
	\label{fig:Contour}
\end{figure}

\section{Discussion}
\label{sec:Discussion} % Our claims
The asymptotic dynamics of our model can be affected by the strength of neutrality on the competition. Particularly, the more neutral our system is, the higher are the chances of developing chaotic behaviour. Going back to the hypotheses about biodiversity mentioned in section \ref{sec:Background}, we claim this observation to be a link between the hypothesis of non-equilibrium and Hubbell's hypothesis of neutrality. Maybe this can be a first step to reconcile both views. 

\paragraph{} % Limitations
Our model is deliberately oversimplified. We didn't use Allee effect, nor noise, and the functional form of each term has been chosen to be the simplest possible realization allowing the expected behaviors. We used the simplest predation network, that is, one with random predation coefficients. Thus, our predators can be considered generalists. A straightforward continuation of this paper could be studying the effect of the type of predation (generalist, specialist, neutral), controlling with a single parameter the \textit{flavour} of the predation matrix $ S $.

\paragraph{} % Chaos detection
Regarding chaos detection, we followed as well a very simple approach: that of Lyapunov exponents analysis plus visual inspection. Numerical detection of chaos is a sub-field by itself, and we are sure there are more robust methods available. We think that our approach to chaos detection, despite being open to improvement, suffices to hold the biological conclusions.

\paragraph{} % The parameter epsilon
Interestingly enough, a relatively small number of iterations suffices to generate a remarkably clear maximum in the probability of chaos for neutral competition. The position of this maximum is independent of the number of interacting species. This suggests that the parameter $ \epsilon $, originally motivated by numerical convenience, may have a biological interpretation by itself. It will be interesting to reverse-engineer this parameter given a set of community matrices validated by experimental or field observations.

\paragraph{} % Role of symmetry
It may be worth noting that the position of both the maxima we've found (i.e.: $ \epsilon = -1 $ and $ \epsilon = 0 $) have something in common: the community matrix $ A $ at those values of the parameter is very symmetric in both cases. It will be interesting to develop a similar method that, instead of varying neutrality, varies the less restrictive property of symmetry.

\paragraph{} % Is chaos more resilient?
Additionaly, we are implicitly assuming without a proof that chaotic ecosystems are fitter than non-chaotic ones. A possible continuation of this research may be the setting of two indepedent ecosystems, one of them chaotic and the other one non-chaotic, and allow them to interact at some point of time (simulating an invasion), in order to assess how much of each of the original ecosystems survives to this traumatic event.

% TODO: count species above threshold

\section{Appendix}
\label{sec:Appendix}

\subsection{Detection of chaos}
\label{subsec:DetectionOfChaos}
Dynamical systems with chaotic attractors are extremely sensitive to initial conditions. Two trajectories whose initial conditions are slightly different will diverge exponentially if they lie in the basin of a chaotic attractor. The initial rate of divergence is quantified by the Lyapunov exponent \cite{Strogatz1994}.

\paragraph{}
Our procedure for classifying the attractors as chaotic or non-chaotic was based in the analysis of Lyapunov exponents. More specifically, this is the procedure we've followed:

\begin{enumerate}
	\item \label{GoToAttractor} Run the simulation for a sufficient time, in order to guarantee that a trajectory reached an attractor and the dynamics are asymptotic.
	\item \label{RunInAttractor} Use the last point of the run in step \ref{GoToAttractor} as a starting point for a second, shorter run on the attractor.
	\item \label{PerturbedTrajectory} Use again the last point of the run in step \ref{GoToAttractor} but, this time, adding a small disturbance to it.
	\item Compare the runs in steps \ref{RunInAttractor} and \ref{PerturbedTrajectory} to compute numerically the principal Lyapunov exponent.
	\begin{itemize}
		\item If it's positive, classify the attractor as chaotic.
		\item If it's negative, classify the attractor as non-chaotic.
	\end{itemize}
\end{enumerate}

%TODO: Big warning here: our method for detecting chaos sometimes gives false positives for complex cycles

\subsection{Neutral competition}
\label{subsec:NeutralCompetition}
If we drop everything but the competition part of our dynamics (see equation \ref{eq:SystemUnderStudy}), we will find a system of equations $ n_P $ like the following:

\begin{eqnarray}
\label{eq:OnlyCompetition}
\dot{P_i} = P_i \left( 1 - \sum_{k=1}^{n_P} A_{ik} \cdot P_k \right)
\end{eqnarray}

In order to model a neutral competition, we should use the same competition coefficient for each species. That is, take $ A_{ik} = A $ for all $ i $ and $ k $, so:

\begin{eqnarray}
\label{eq:OnlyNeutralCompetition}
\dot{P_i} = P_i \left( 1 - A \sum_{k=1}^{n_P} P_k \right)
\end{eqnarray}

From equation \ref{eq:OnlyNeutralCompetition} we see that all species have exactly the same dynamical equation. This will make the nullclines to coincide at all points, so the equilibrium points will degenerate to equilibrium manifolds.

\begin{figure}[h]
	\begin{center}
		\includegraphics[width=0.9\columnwidth]{degenerate.png}
	\end{center}
	\caption{Example with $2$ prey under neutral competition. Both nullclines coincide point to point, giving rise to a higher dimensional equilibirium manifold (in this case, a straight line)}
	\label{fig:Neutral}
\end{figure}

This problem can be solved more easily noticing that, from the sole point of view of competition, the effect of neutrality is to fade out the differences between species. Being this the case, the labels $ i $ distinguishing them become pointless. It is a good idea to sum up all the competing species into a new variable, that of total population of (now indistinguishable) species, defined by:

\begin{eqnarray}
\label{eq:TotalPopulation}
	T(t) = \sum_{i=1}^{n_P} P_i(t)
\end{eqnarray}

It can be shown using equation \ref{eq:OnlyNeutralCompetition} that, as expected from the biological intuition, the dynamics of this new variable will follow the same differential equation as the individual species abundances. This collapses the $ n_P $ dimensions of our original problem to a single one.

\begin{eqnarray}
\label{eq:TotalPopulationDynamics}
	\dot T(t) = \sum_{i=1}^{n_P} \dot P_i(t) = T (1 - A T)
\end{eqnarray}

In our model, the predation interaction breaks this excess of symmetry, so we can still work with neutral competition as long as the predation is not neutral without facing problems of system degeneration.


\section{Acknowledgements}
\label{sec:Acknowledgements}
The preliminary analysis of this model were performed using GRIND for Matlab (http://www.sparcs-center.org/grind). Additionally, we thank Jelle Lever, Moussa N'Dour and Sebastian Bathiany for their useful comments and suggestions.

\clearpage

% TODO: format citations
\bibliography{library}
%\bibliographystyle{ieeetr}
\bibliographystyle{apalike}

\iftoggle{journalDraft}
{
	\listoftables
	\listoffigures
}

\end{document}